<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - MovieTrack</title>
    <link rel="icon" href="assets/logo.svg" type="image/svg+xml">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="container">
            <!-- Hamburger Menu Button -->
            <button class="hamburger-menu" id="hamburgerBtn" title="Menu">
                <i class="fas fa-bars"></i>
            </button>
            
            <div class="nav-brand">
                <a href="dashboard.html" class="logo-link">
                    <img src="assets/logo.svg" alt="MovieTrack Logo" class="logo-svg">
                    <h1>MOVIETRACK</h1>
                </a>
            </div>
            <ul class="nav-menu">
                <li><a href="dashboard.html" class="active"><i class="fas fa-th-large"></i> Dashboard</a></li>
                <li><a href="categories.html"><i class="fas fa-layer-group"></i> Categories</a></li>
                <li><a href="#" id="viewModeBtn" class="view-mode-btn" title="Change View Mode"><i class="fas fa-th"></i></a></li>
                <li><a href="#" id="themeToggleBtn" class="theme-toggle-btn" title="Toggle Theme"><i class="fas fa-moon"></i></a></li>
                
                <!-- Notification Bell -->
                <li class="notification-bell-container desktop-notification">
                    <a href="#" id="notificationBellBtn" class="notification-bell-btn" title="Notifications">
                        <i class="fas fa-bell"></i>
                        <span class="notification-badge" id="notificationBadge" style="display: none;">0</span>
                    </a>
                    
                    <!-- Notification Dropdown -->
                    <div class="notification-dropdown" id="notificationDropdown" style="display: none;">
                        <div class="notification-header">
                            <h3><i class="fas fa-bell"></i> Notifications</h3>
                            <button class="close-notification-btn" id="closeNotificationBtn">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                        
                        <!-- Filter Tabs -->
                        <div class="notification-filters">
                            <button class="filter-btn active" data-filter="all">
                                <i class="fas fa-inbox"></i> All
                            </button>
                            <button class="filter-btn" data-filter="info">
                                <i class="fas fa-info-circle"></i> Info
                            </button>
                            <button class="filter-btn" data-filter="success">
                                <i class="fas fa-check-circle"></i> Success
                            </button>
                            <button class="filter-btn" data-filter="warning">
                                <i class="fas fa-exclamation-triangle"></i> Warning
                            </button>
                            <button class="filter-btn" data-filter="error">
                                <i class="fas fa-times-circle"></i> Critical
                            </button>
                        </div>
                        
                        <!-- Mute Toggle -->
                        <div class="notification-mute">
                            <label class="mute-toggle">
                                <input type="checkbox" id="muteNotifications">
                                <span class="mute-slider"></span>
                                <span class="mute-label">
                                    <i class="fas fa-bell-slash"></i> Mute for 24 hours
                                </span>
                            </label>
                        </div>
                        
                        <!-- Notification List -->
                        <div class="notification-list" id="notificationList">
                            <div class="notification-empty">
                                <i class="fas fa-bell"></i>
                                <p>No notifications</p>
                            </div>
                        </div>
                        
                        <!-- Footer Actions -->
                        <div class="notification-footer">
                            <button class="mark-all-read-btn" id="markAllReadBtn">
                                <i class="fas fa-check-double"></i> Mark All as Read
                            </button>
                        </div>
                    </div>
                </li>
                
                <li class="profile-container">
                    <a href="#" id="profileBtn" class="profile-icon">
                        <i class="fas fa-user-circle"></i>
                        <span class="profile-notification-badge" id="profileNotificationBadge" style="display: none;">0</span>
                    </a>
                </li>
                <li><a href="#" id="logoutBtn"><i class="fas fa-sign-out-alt"></i> Logout</a></li>
            </ul>
        </div>
    </nav>

    <!-- Sidebar -->
    <div id="sidebar" class="sidebar">
        <div class="sidebar-header">
            <h3><i class="fas fa-film"></i> Menu</h3>
            <button class="close-sidebar" id="closeSidebarBtn">
                <i class="fas fa-times"></i>
            </button>
        </div>
        
        <div class="sidebar-content">
            <!-- Search in Sidebar -->
            <div class="sidebar-search">
                <input type="text" id="sidebarSearchInput" placeholder="Search movies & TV shows...">
                <i class="fas fa-search"></i>
                <div id="sidebarSearchResults" class="tmdb-results" style="display: none;"></div>
            </div>
            
            <ul class="sidebar-menu">
                <!-- Active Features -->
                <li class="menu-section-title">Browse</li>
                <li>
                    <a href="#" id="sidebarUpcoming">
                        <i class="fas fa-clock"></i>
                        <span>Upcoming Releases</span>
                    </a>
                </li>
                <li>
                    <a href="#" id="sidebarCategories">
                        <i class="fas fa-th-large"></i>
                        <span>Categories</span>
                    </a>
                </li>
                
                <li class="menu-divider"></li>
                
                <!-- Features -->
                <li class="menu-section-title">Features</li>
                <li>
                    <a href="#" id="sidebarAnalytics">
                        <i class="fas fa-chart-line"></i>
                        <span>Analytics</span>
                    </a>
                </li>
                <li>
                    <a href="#" id="sidebarAchievements">
                        <i class="fas fa-trophy"></i>
                        <span>Achievements</span>
                    </a>
                </li>
                <li>
                    <a href="tags-lists.html">
                        <i class="fas fa-tags"></i>
                        <span>Tags & Lists</span>
                        <span class="badge new">New</span>
                    </a>
                </li>
                <li>
                    <a href="calendar.html">
                        <i class="fas fa-calendar-alt"></i>
                        <span>Watch Calendar</span>
                        <span class="badge new">New</span>
                    </a>
                </li>
                <li>
                    <a href="streaming.html">
                        <i class="fas fa-play-circle"></i>
                        <span>Streaming</span>
                        <span class="badge new">New</span>
                    </a>
                </li>
              
             
                <li>
                    <a href="settings.html" id="sidebarSettings">
                        <i class="fas fa-cog"></i>
                        <span>Settings</span>
                    </a>
                </li>
            </ul>
        </div>
    </div>

    <!-- Sidebar Overlay -->
    <div id="sidebarOverlay" class="sidebar-overlay"></div>

    <!-- Profile Modal -->
    <div id="profileModal" class="modal" style="display: none;">
        <div class="modal-content modal-profile">
            <span class="close" onclick="document.getElementById('profileModal').style.display='none'">&times;</span>
            <div class="profile-header">
                <div class="profile-avatar">
                    <i class="fas fa-user-circle"></i>
                </div>
                <div class="profile-name-container">
                    <h2 id="profileName">User</h2>
                    <button id="editNameBtn" class="btn-edit-name" title="Edit Name">
                        <i class="fas fa-edit"></i>
                    </button>
                </div>
                <p id="profileEmail" class="profile-email">user@example.com</p>
            </div>
            
            <div id="editNameSection" class="edit-name-section" style="display: none;">
                <div class="edit-name-form">
                    <h4><i class="fas fa-user-edit"></i> Edit Username</h4>
                    <input 
                        type="text" 
                        id="newUserName" 
                        placeholder="Enter new username"
                        maxlength="50"
                    />
                    <div class="edit-name-actions">
                        <button class="btn btn-primary" id="saveNameBtn">
                            <i class="fas fa-save"></i> Save
                        </button>
                        <button class="btn btn-secondary" id="cancelNameBtn">
                            <i class="fas fa-times"></i> Cancel
                        </button>
                    </div>
                </div>
            </div>
            
            <div class="profile-stats-grid">
                <div class="profile-stat-item">
                    <div class="profile-stat-icon">
                        <i class="fas fa-film"></i>
                    </div>
                    <div class="profile-stat-info">
                        <h3 id="profileTotalMovies">0</h3>
                        <p>Total Content</p>
                    </div>
                </div>
                <div class="profile-stat-item">
                    <div class="profile-stat-icon">
                        <i class="fas fa-eye"></i>
                    </div>
                    <div class="profile-stat-info">
                        <h3 id="profileWatchedCount">0</h3>
                        <p>Watched</p>
                    </div>
                </div>
                <div class="profile-stat-item">
                    <div class="profile-stat-icon">
                        <i class="fas fa-star"></i>
                    </div>
                    <div class="profile-stat-info">
                        <h3 id="profileAvgRating">0</h3>
                        <p>Avg Rating</p>
                    </div>
                </div>
                <div class="profile-stat-item">
                    <div class="profile-stat-icon">
                        <i class="fas fa-clock"></i>
                    </div>
                    <div class="profile-stat-info">
                        <h3 id="profileWatchlistCount">0</h3>
                        <p>Watchlist</p>
                    </div>
                </div>
            </div>

            <div class="profile-details">
                <h3><i class="fas fa-info-circle"></i> Account Details</h3>
                <div class="profile-detail-item">
                    <span class="detail-label"><i class="fas fa-calendar"></i> Member Since:</span>
                    <span class="detail-value" id="profileMemberSince">Loading...</span>
                </div>
                <div class="profile-detail-item">
                    <span class="detail-label"><i class="fas fa-heart"></i> Favorite Genre:</span>
                    <span class="detail-value" id="profileFavoriteGenre">Loading...</span>
                </div>
                <div class="profile-detail-item">
                    <span class="detail-label"><i class="fas fa-trophy"></i> Most Watched:</span>
                    <span class="detail-value" id="profileMostWatched">Movies</span>
                </div>
            </div>
            
            <!-- Profile Actions -->
            <div class="profile-actions">
                <a href="settings.html" class="btn btn-secondary btn-profile-action">
                    <i class="fas fa-cog"></i> Settings
                </a>
                <button id="profileLogoutBtn" class="btn btn-danger btn-profile-action">
                    <i class="fas fa-sign-out-alt"></i> Logout
                </button>
            </div>
        </div>
    </div>

    <!-- Dashboard Section -->
    <section class="dashboard">
        <div class="container">
            <div class="dashboard-header">
                <h2><i class="fas fa-th-large"></i> My Dashboard</h2>
                <p>Welcome back, <strong id="userName">User</strong>! üé¨</p>
            </div>

            <!-- Announcements Container -->
            <div id="announcementsContainer"></div>

            <!-- Stats Cards -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon"><i class="fas fa-film"></i></div>
                    <div class="stat-content">
                        <h3 id="totalMovies">0</h3>
                        <p>Total Movies</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon"><i class="fas fa-check-circle"></i></div>
                    <div class="stat-content">
                        <h3 id="watchedMovies">0</h3>
                        <p>Watched</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon"><i class="fas fa-clock"></i></div>
                    <div class="stat-content">
                        <h3 id="watchlistMovies">0</h3>
                        <p>Watchlist</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon"><i class="fas fa-star"></i></div>
                    <div class="stat-content">
                        <h3 id="avgRating">0</h3>
                        <p>Avg Rating</p>
                    </div>
                </div>
            </div>

            <!-- Add Movie Section -->
            <div class="add-movie-section">
                <h3><i class="fas fa-plus-circle"></i> Add New Content</h3>
                <form id="addMovieForm" class="movie-form">
                    <div class="form-row">
                        <div class="form-group">
                            <select id="contentType" required>
                                <option value="movie">üé¨ Movie</option>
                                <option value="tv">üì∫ TV Show</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <input type="text" id="movieTitle" placeholder="Title" required>
                        </div>
                        <div class="form-group">
                            <input type="number" id="movieYear" placeholder="Year" min="1900" max="2025">
                        </div>
                        <div class="form-group">
                            <select id="movieStatus" required>
                                <option value="">Select Status</option>
                                <option value="watched">Watched</option>
                                <option value="watching">Watching</option>
                                <option value="watchlist">Watchlist</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <select id="movieRating">
                                <option value="">Rating</option>
                                <option value="5">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</option>
                                <option value="4">‚≠ê‚≠ê‚≠ê‚≠ê</option>
                                <option value="3">‚≠ê‚≠ê‚≠ê</option>
                                <option value="2">‚≠ê‚≠ê</option>
                                <option value="1">‚≠ê</option>
                            </select>
                        </div>
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-plus"></i> Add
                        </button>
                    </div>
                    <div id="tvShowFields" style="display: none; margin-top: 15px;">
                        <div class="form-row">
                            <div class="form-group">
                                <input type="number" id="currentSeason" placeholder="Current Season" min="1">
                            </div>
                            <div class="form-group">
                                <input type="number" id="currentEpisode" placeholder="Current Episode" min="1">
                            </div>
                        </div>
                    </div>
                    <div id="watchedDateContainer" style="display: none; margin-top: 15px;">
                        <div class="form-group">
                            <label for="watchedDate" style="display: flex; align-items: center; gap: 8px; color: #ffffff; margin-bottom: 8px; font-size: 14px;">
                                <i class="fas fa-calendar"></i> Watched Date
                            </label>
                            <input type="date" id="watchedDate" max="${new Date().toISOString().split('T')[0]}" style="width: 250px;">
                        </div>
                    </div>
                </form>
            </div>

            <!-- Recommendations Section -->
            <div class="recommendations-section" id="recommendationsSection" style="display: none;">
                <h3><i class="fas fa-magic"></i> Recommended for You</h3>
                <p class="recommendations-subtitle">Based on your highest-rated content</p>
                <div class="recommendations-carousel" id="recommendationsCarousel">
                    <!-- Recommendations will be dynamically added here -->
                </div>
            </div>

            <!-- Search & Filter Section -->
            <div class="filter-section">
                <h3><i class="fas fa-video"></i> My Collection</h3>
                <div class="search-filter-wrapper">
                    <div class="search-box">
                        <input type="text" id="searchInput" placeholder="Search by title, director, or genre..." />
                        <button id="searchBtn" class="btn-icon-search">
                            <i class="fas fa-search"></i>
                        </button>
                        <button id="clearSearch" class="btn-icon-clear" style="display:none;">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="all-filters-row">
                        <div class="filter-buttons">
                            <button class="filter-btn active" data-filter="all">All</button>
                            <button class="filter-btn" data-filter="watched">Watched</button>
                            <button class="filter-btn" data-filter="watchlist">Watchlist</button>
                            <button class="filter-btn" data-filter="watching">Watching</button>
                        </div>
                        <div class="type-filter-buttons">
                            <button class="type-filter-btn" data-type="movie">
                                <i class="fas fa-film"></i> Movies
                            </button>
                            <button class="type-filter-btn" data-type="tv">
                                <i class="fas fa-tv"></i> TV Shows
                            </button>
                        </div>
                        <div class="sort-dropdown">
                            <label for="sortSelect"><i class="fas fa-sort"></i> Sort by:</label>
                            <select id="sortSelect">
                                <option value="title-asc">Title (A-Z)</option>
                                <option value="title-desc">Title (Z-A)</option>
                                <option value="year-desc">Year (Newest)</option>
                                <option value="year-asc">Year (Oldest)</option>
                                <option value="rating-desc">Rating (Highest)</option>
                                <option value="rating-asc">Rating (Lowest)</option>
                                <option value="date-desc">Recently Added</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Movies List -->
            <div class="movies-grid" id="moviesContainer">
                <!-- Movies will be dynamically added here -->
                <div class="empty-state">
                    <p>No movies yet. Add your first movie above!</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer>
        <div class="container">
            <p>&copy; 2025 Movie Tracker. All rights reserved.</p>
        </div>
    </footer>

    <div id="toast-container"></div>

    <!-- Custom Confirmation Modal -->
    <div id="confirmModal" class="confirm-modal">
        <div class="confirm-modal-content">
            <div class="confirm-modal-icon">
                <i class="fas fa-exclamation-triangle"></i>
            </div>
            <h3 id="confirmModalTitle">Confirm Action</h3>
            <p id="confirmModalMessage">Are you sure you want to proceed?</p>
            <div class="confirm-modal-actions">
                <button class="btn btn-danger" id="confirmModalYes">
                    <i class="fas fa-check"></i> Yes
                </button>
                <button class="btn btn-secondary" id="confirmModalNo">
                    <i class="fas fa-times"></i> Cancel
                </button>
            </div>
        </div>
    </div>

    <!-- Analytics Modal -->
    <div id="analyticsModal" class="analytics-modal">
        <div class="analytics-modal-content">
            <div class="analytics-modal-header">
                <h2><i class="fas fa-chart-line"></i> Your Movie Analytics</h2>
                <button class="close-analytics" id="closeAnalytics">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="analytics-body">
                <!-- Quick Stats Grid -->
                <div class="analytics-stats-grid">
                    <div class="analytics-stat-card">
                        <div class="analytics-stat-icon">
                            <i class="fas fa-film"></i>
                        </div>
                        <div class="analytics-stat-info">
                            <h3 id="analyticsTotal">0</h3>
                            <p>Total Content</p>
                        </div>
                    </div>
                    <div class="analytics-stat-card">
                        <div class="analytics-stat-icon">
                            <i class="fas fa-clock"></i>
                        </div>
                        <div class="analytics-stat-info">
                            <h3 id="analyticsTotalHours">0h</h3>
                            <p>Est. Watch Time</p>
                        </div>
                    </div>
                    <div class="analytics-stat-card">
                        <div class="analytics-stat-icon">
                            <i class="fas fa-star"></i>
                        </div>
                        <div class="analytics-stat-info">
                            <h3 id="analyticsAvgRating">0.0</h3>
                            <p>Avg Rating</p>
                        </div>
                    </div>
                    <div class="analytics-stat-card">
                        <div class="analytics-stat-icon">
                            <i class="fas fa-fire"></i>
                        </div>
                        <div class="analytics-stat-info">
                            <h3 id="analyticsStreak">0</h3>
                            <p>Day Streak</p>
                        </div>
                    </div>
                </div>

                <!-- Charts Section -->
                <div class="analytics-charts">
                    <div class="analytics-chart-card">
                        <h3><i class="fas fa-chart-pie"></i> Content Distribution</h3>
                        <canvas id="contentTypeChart"></canvas>
                    </div>
                    
                    <div class="analytics-chart-card">
                        <h3><i class="fas fa-chart-bar"></i> Top Genres</h3>
                        <canvas id="genreChart"></canvas>
                    </div>
                    
                    <div class="analytics-chart-card full-width">
                        <h3><i class="fas fa-chart-line"></i> Rating Distribution</h3>
                        <canvas id="ratingChart"></canvas>
                    </div>

                    <div class="analytics-chart-card full-width">
                        <h3><i class="fas fa-calendar-alt"></i> Watch Activity</h3>
                        <canvas id="activityChart"></canvas>
                    </div>
                </div>

                <!-- Top Movies Lists -->
                <div class="analytics-lists">
                    <div class="analytics-list-card">
                        <h3><i class="fas fa-trophy"></i> Highest Rated</h3>
                        <div id="topRatedList" class="analytics-movie-list">
                            <!-- Dynamic content -->
                        </div>
                    </div>
                    
                    <div class="analytics-list-card">
                        <h3><i class="fas fa-heart"></i> Most Recent</h3>
                        <div id="recentList" class="analytics-movie-list">
                            <!-- Dynamic content -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Achievements Modal -->
    <div id="achievementsModal" class="achievements-modal">
        <div class="achievements-modal-content">
            <div class="achievements-modal-header">
                <h2><i class="fas fa-trophy"></i> Achievements</h2>
                <button class="close-achievements" id="closeAchievements">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="achievements-body" id="achievementsContent">
                <!-- Achievements will be populated by JS -->
            </div>
        </div>
    </div>

    <!-- Achievement Notification Container -->
    <div id="achievement-container"></div>

    <!-- Back to Top Button -->
    <button id="backToTopBtn" title="Go to top"><i class="fas fa-arrow-up"></i></button>

    <script src="js/config.js"></script>
    <script src="js/apply-settings.js"></script>
    <script src="js/api.js?v=3.0"></script>
    <script src="js/omdb.js?v=3.0"></script>
    <script src="js/tmdb.js?v=3.0"></script>
    <script src="js/achievements.js?v=3.0"></script>
    <script src="js/episode-tracker.js?v=3.0"></script>
    <script src="js/dashboard-enhanced.js?v=3.5"></script>
</body>
</html>
